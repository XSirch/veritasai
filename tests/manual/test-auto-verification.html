<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Teste de Verifica√ß√£o Autom√°tica - VeritasAI</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            line-height: 1.6;
        }
        .test-section {
            margin: 30px 0;
            padding: 20px;
            border: 1px solid #ddd;
            border-radius: 8px;
            background: #f9f9f9;
        }
        .test-text {
            background: white;
            padding: 15px;
            border-radius: 4px;
            margin: 10px 0;
            border-left: 4px solid #007cba;
        }
        .instructions {
            background: #e7f3ff;
            padding: 15px;
            border-radius: 4px;
            margin: 10px 0;
        }
        .status {
            padding: 10px;
            margin: 10px 0;
            border-radius: 4px;
            font-weight: bold;
        }
        .status.success { background: #d4edda; color: #155724; }
        .status.warning { background: #fff3cd; color: #856404; }
        .status.error { background: #f8d7da; color: #721c24; }
        
        .config-panel {
            background: #f0f0f0;
            padding: 15px;
            border-radius: 4px;
            margin: 20px 0;
        }
        
        button {
            background: #007cba;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 4px;
            cursor: pointer;
            margin: 5px;
        }
        
        button:hover {
            background: #005a87;
        }
        
        .highlight {
            background: yellow;
            padding: 2px 4px;
        }
    </style>
</head>
<body>
    <h1>üîç Teste de Verifica√ß√£o Autom√°tica - VeritasAI</h1>
    
    <div class="instructions">
        <h3>üìã Instru√ß√µes de Teste</h3>
        <ol>
            <li>Certifique-se de que a extens√£o VeritasAI est√° instalada e ativa</li>
            <li>Configure a verifica√ß√£o autom√°tica usando os bot√µes abaixo</li>
            <li>Selecione os textos de teste para verificar o comportamento</li>
            <li>Observe se a verifica√ß√£o √© executada automaticamente ou se mostra o bot√£o</li>
        </ol>
    </div>

    <div class="config-panel">
        <h3>‚öôÔ∏è Configura√ß√£o de Teste</h3>
        <button onclick="enableAutoVerify()">‚úÖ Habilitar Verifica√ß√£o Autom√°tica</button>
        <button onclick="disableAutoVerify()">‚ùå Desabilitar Verifica√ß√£o Autom√°tica</button>
        <button onclick="checkCurrentConfig()">üîç Verificar Configura√ß√£o Atual</button>
        <div id="config-status" class="status"></div>
    </div>

    <div class="test-section">
        <h3>üß™ Teste 1: Afirma√ß√£o Cient√≠fica</h3>
        <div class="test-text">
            A <span class="highlight">Terra √© plana e o aquecimento global √© uma farsa criada pelos cientistas</span> para obter mais financiamento para suas pesquisas.
        </div>
        <p><strong>Comportamento esperado:</strong></p>
        <ul>
            <li><strong>Auto-verifica√ß√£o ON:</strong> Verifica√ß√£o autom√°tica ao selecionar o texto destacado</li>
            <li><strong>Auto-verifica√ß√£o OFF:</strong> Bot√£o de verifica√ß√£o aparece ao selecionar</li>
        </ul>
    </div>

    <div class="test-section">
        <h3>üß™ Teste 2: Estat√≠stica</h3>
        <div class="test-text">
            Segundo estudos recentes, <span class="highlight">99% dos cientistas concordam que as vacinas causam autismo</span> e que isso √© amplamente aceito pela comunidade m√©dica.
        </div>
        <p><strong>Comportamento esperado:</strong> Detec√ß√£o de conte√∫do estat√≠stico e verifica√ß√£o apropriada.</p>
    </div>

    <div class="test-section">
        <h3>üß™ Teste 3: Cita√ß√£o/Fonte</h3>
        <div class="test-text">
            De acordo com a NASA, <span class="highlight">"nunca pousamos na Lua e todas as miss√µes Apollo foram encenadas em um est√∫dio de Hollywood"</span>, conforme declarado oficialmente em 2023.
        </div>
        <p><strong>Comportamento esperado:</strong> Detec√ß√£o de cita√ß√£o e verifica√ß√£o de fonte.</p>
    </div>

    <div class="test-section">
        <h3>üß™ Teste 4: Texto Muito Curto (deve ser ignorado)</h3>
        <div class="test-text">
            <span class="highlight">Ol√°</span>
        </div>
        <p><strong>Comportamento esperado:</strong> Texto muito curto deve ser ignorado (menos de 10 caracteres).</p>
    </div>

    <div class="test-section">
        <h3>üß™ Teste 5: Texto Normal (n√£o controverso)</h3>
        <div class="test-text">
            <span class="highlight">O c√©u √© azul durante o dia devido ao espalhamento da luz solar na atmosfera</span>, um fen√¥meno bem compreendido pela f√≠sica.
        </div>
        <p><strong>Comportamento esperado:</strong> Verifica√ß√£o normal de informa√ß√£o factual.</p>
    </div>

    <div id="test-results" class="status" style="display: none;">
        <h3>üìä Resultados dos Testes</h3>
        <div id="results-content"></div>
    </div>

    <script>
        // Fun√ß√µes para controlar a configura√ß√£o de auto-verifica√ß√£o
        async function enableAutoVerify() {
            try {
                // Simular habilita√ß√£o da auto-verifica√ß√£o
                if (typeof chrome !== 'undefined' && chrome.runtime) {
                    await chrome.runtime.sendMessage({
                        action: 'updateSettings',
                        settings: { autoVerify: true }
                    });
                }
                
                // Atualizar configura√ß√£o local para teste
                if (window.VeritasAI && window.VeritasAI.VERITAS_CONFIG) {
                    window.VeritasAI.VERITAS_CONFIG.AUTO_VERIFY = true;
                }
                
                updateConfigStatus('Verifica√ß√£o autom√°tica HABILITADA', 'success');
                console.log('‚úÖ Auto-verifica√ß√£o habilitada');
            } catch (error) {
                updateConfigStatus('Erro ao habilitar auto-verifica√ß√£o: ' + error.message, 'error');
                console.error('‚ùå Erro:', error);
            }
        }

        async function disableAutoVerify() {
            try {
                // Simular desabilita√ß√£o da auto-verifica√ß√£o
                if (typeof chrome !== 'undefined' && chrome.runtime) {
                    await chrome.runtime.sendMessage({
                        action: 'updateSettings',
                        settings: { autoVerify: false }
                    });
                }
                
                // Atualizar configura√ß√£o local para teste
                if (window.VeritasAI && window.VeritasAI.VERITAS_CONFIG) {
                    window.VeritasAI.VERITAS_CONFIG.AUTO_VERIFY = false;
                }
                
                updateConfigStatus('Verifica√ß√£o autom√°tica DESABILITADA', 'warning');
                console.log('‚ö†Ô∏è Auto-verifica√ß√£o desabilitada');
            } catch (error) {
                updateConfigStatus('Erro ao desabilitar auto-verifica√ß√£o: ' + error.message, 'error');
                console.error('‚ùå Erro:', error);
            }
        }

        async function checkCurrentConfig() {
            try {
                let autoVerifyStatus = 'Desconhecido';
                
                // Verificar configura√ß√£o via extension
                if (typeof chrome !== 'undefined' && chrome.runtime) {
                    const response = await chrome.runtime.sendMessage({
                        action: 'getSettings'
                    });
                    if (response && response.success) {
                        autoVerifyStatus = response.data.autoVerify ? 'HABILITADA' : 'DESABILITADA';
                    }
                }
                
                // Verificar configura√ß√£o local
                if (window.VeritasAI && window.VeritasAI.VERITAS_CONFIG) {
                    const localStatus = window.VeritasAI.VERITAS_CONFIG.AUTO_VERIFY ? 'HABILITADA' : 'DESABILITADA';
                    autoVerifyStatus += ` (Local: ${localStatus})`;
                }
                
                updateConfigStatus(`Status atual: ${autoVerifyStatus}`, 'success');
                console.log('üîç Status verificado:', autoVerifyStatus);
            } catch (error) {
                updateConfigStatus('Erro ao verificar configura√ß√£o: ' + error.message, 'error');
                console.error('‚ùå Erro:', error);
            }
        }

        function updateConfigStatus(message, type) {
            const statusEl = document.getElementById('config-status');
            statusEl.textContent = message;
            statusEl.className = `status ${type}`;
            statusEl.style.display = 'block';
        }

        // Listener para eventos da extens√£o
        document.addEventListener('veritas:text-selected', (event) => {
            console.log('üìù Evento de sele√ß√£o detectado:', event.detail);
            logTestResult('Texto selecionado detectado', event.detail);
        });

        document.addEventListener('veritas:verify-request', (event) => {
            console.log('üîç Evento de verifica√ß√£o detectado:', event.detail);
            logTestResult('Verifica√ß√£o autom√°tica executada', event.detail);
        });

        function logTestResult(action, data) {
            const resultsEl = document.getElementById('test-results');
            const contentEl = document.getElementById('results-content');
            
            const timestamp = new Date().toLocaleTimeString();
            const logEntry = document.createElement('div');
            logEntry.innerHTML = `
                <strong>${timestamp}:</strong> ${action}<br>
                <small>Dados: ${JSON.stringify(data, null, 2)}</small>
            `;
            logEntry.style.marginBottom = '10px';
            logEntry.style.padding = '5px';
            logEntry.style.background = '#f0f0f0';
            logEntry.style.borderRadius = '4px';
            
            contentEl.appendChild(logEntry);
            resultsEl.style.display = 'block';
            
            // Scroll para o resultado
            logEntry.scrollIntoView({ behavior: 'smooth' });
        }

        // Inicializa√ß√£o
        document.addEventListener('DOMContentLoaded', () => {
            console.log('üöÄ P√°gina de teste carregada');
            updateConfigStatus('P√°gina carregada. Clique em "Verificar Configura√ß√£o Atual" para come√ßar.', 'warning');
        });
    </script>
</body>
</html>
